<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
		<link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css">
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="js/jquery.mobile-1.3.2.min.js"></script>
		<style type="text/css">
			body {background-color: #88a6b1}
			.round {
				display: inline-block;
    			text-align: center;
			    box-shadow: inset 1px -6px 10px #fff;
			    width: .9rem;
			    height: .9rem;
			    border-radius: .9rem;
			    background: #d5d5d5;
			    color: #000!important;
			    margin-right: .1rem;
			    line-height: .9rem;
			    font-size: .6rem;
			}
			
			.textCenter {
				text-align: center;
			}
			
			.col {
			    padding: .4rem 0;
			    font-size: .92rem;
			}
			
			.bet {
				font-weight: bolder;
    			color: rgba(0, 0, 0, .8);
			}
			
			.bet-content {
			    display: inline-block;
			    line-height: 1.4rem;
			}
			
			.round-1 {
				line-height: 1.4rem;
				display: inline-block;
				text-align: center;
				box-shadow: inset 1px -6px 10px #fff;
				background: #d5d5d5;
				color: #000!important;
			    width: 1.4rem;
			    height: 1.4rem;
			    border-radius: 1.4rem;
			    font-size: .9rem;
			    font-weight: bolder;
			}
			
			#rightTwoDiv {
				overflow: scroll;
			}
		</style>
		
		<script type="text/javascript">
			var domain = 'http://localhost:8899';
			var userName;
			var token;
			$(function(){
				var screen = $.mobile.getScreenHeight();
				var header = $(".ui-header").hasClass("ui-header-fixed") ? $(".ui-header").outerHeight()  - 1 : $(".ui-header").outerHeight();
				var footer = $(".ui-footer").hasClass("ui-footer-fixed") ? $(".ui-footer").outerHeight() - 1 : $(".ui-footer").outerHeight();
				var contentCurrent = $(".ui-content").outerHeight() - $(".ui-content").height();
				var content = screen - header - footer - contentCurrent;
				$(".ui-content").height(content);
				
				var beforPeriodDivHeight = $('#beforPeriodDiv').outerHeight();
				var nowPeriodDivHeight = $('#nowPeriodDiv').outerHeight();
				
				var gameDivHeight = content - beforPeriodDivHeight - nowPeriodDivHeight;
				$('#gameDiv').height(gameDivHeight);
				$('#leftDiv').height(gameDivHeight);
				$('#rightOneDiv').height(gameDivHeight);
				$('#rightTwoDiv').height(gameDivHeight);
				$('#rightThreeDiv').height(gameDivHeight);
				
				var gameDivWidth = $('#gameDiv').width() - $('#leftDiv').width();
				$('#rightOneDiv').width(gameDivWidth);
				$('#rightTwoDiv').width(gameDivWidth);
				$('#rightThreeDiv').width(gameDivWidth);
			});
			
			$(document).on('pageinit', '#mainPage', function () {
				getBeforPeriod();
				getNowPeriod();
			});
			
			/* function setHeight(nextPage) {
				var screen = $.mobile.getScreenHeight();
			    var header = nextPage.children(".ui-header").hasClass("ui-header-fixed") ? nextPage.children(".ui-header").outerHeight() - 1 : nextPage.children(".ui-header").outerHeight();
			    var footer = nextPage.children(".ui-footer").hasClass("ui-footer-fixed") ? nextPage.children(".ui-footer").outerHeight() - 1 : nextPage.children(".ui-footer").outerHeight();
			    var contentCurrent = nextPage.children(".ui-content").outerHeight() - nextPage.children(".ui-content").height();
			    var content = screen - header - footer - contentCurrent;
			    nextPage.children(".ui-content").height(content);
			}
			
			function initHeightSetting(yourFirstPageId) {
			    // 这段代码在初始化的时候执行.设置第一个页面的高度
			    setHeight($(yourFirstPageId));

			    // 在页面显示前会执行下面代码.设置高度
			    $("body").on("pagecontainershow", function(event, ui) {
			        var nextPage = $(ui.toPage[0]);
			        setHeight(nextPage);
			    });
			} */
			
			function login() {
				//domain + '/lottery/user/login'?account=hermes&pwd=21232f297a57a5a743894a0e4a801fc3
				var account = $('#account').val();
				var pwd = $('#pwd').val();
				$.ajax({
					url: domain + '/lottery/user/login',
					dataType: 'json',
					async: true,
					data: {
						'account': account,
						'pwd': pwd
					},
					success: function (result) {
						if(result.code == 200){
							userName = result.data.name;
							token = result.data.token;
							$('#loginPage').dialog('close');
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
			}
			
			function getBeforPeriod() {
				$.ajax({
					url: domain + '/lottery/period/beforPeriod',
					dataType: 'json',
					async: true,
					success: function (result) {
						if(result.code == 200){
							if(result.data){
								$('#beforCode').html(result.data.code);
								
								if(result.data.result){
									var resultArr = result.data.result.split(',');
									$('#round1').html(resultArr[0]);
									$('#round2').html(resultArr[1]);
									$('#round3').html(resultArr[2]);
									$('#round4').html(resultArr[3]);
									$('#round5').html(resultArr[4]);
								}
							}
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
			}
			
			function getNowPeriod() {
				$.ajax({
					url: domain + '/lottery/period/nowPeriod',
					dataType: 'json',
					async: true,
					success: function (result) {
						if(result.code == 200){
							if(result.data){
								$('#nowCode').html(result.data.code);
								
								if(result.data.status == 0){
									var endTime = result.data.endTime;
									var finishTime = result.data.finishTime;
									var periodTimer = setInterval(function(){
										if(endTime > 0){
											var endS = parseInt(endTime / 60);
											if(endS < 10){
												endS = '0' + endS;
											}
											
											var endM = endTime % 60;
											if(endM < 10){
												endM = '0' + endM;
											}
											
											$('#endTimeSpan').html(endS + ":" + endM);
											endTime -= 1;
										}else{
											$('#endTimeSpan').html('已封盘');
										}
										
										if(finishTime > 0){
											var endS = parseInt(finishTime / 60);
											if(endS < 10){
												endS = '0' + endS;
											}
											
											var endM = finishTime % 60;
											if(endM < 10){
												endM = '0' + endM;
											}
											
											$('#finishTimeSpan').html(endS + ":" + endM);
											finishTime -= 1;
										}else{
											clearInterval(periodTimer);
											getBeforPeriod();
											getNowPeriod();
										}
									}, 1000);
								}
							}
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
			}
			
			function showRightDiv(showName) {
				if('rightOneDiv' == showName){
					$('#rightOneDiv').css("display", "block");
				}else{
					$('#rightOneDiv').css("display", "none");
				}
				
				if('rightTwoDiv' == showName){
					$('#rightTwoDiv').css("display", "block");
				}else{
					$('#rightTwoDiv').css("display", "none");
				}
				
				if('rightThreeDiv' == showName){
					$('#rightThreeDiv').css("display", "block");
				}else{
					$('#rightThreeDiv').css("display", "none");
				}
			}
		</script>
	</head>
	
	<body>
		<div data-role="page" id="mainPage">
			<div data-role="header">
				<h1>欢迎来到我的主页</h1>
				<a class="ui-btn-right" data-rel="dialog" href="#loginPage">登陆</a>
			</div>
			
			<div id="contentDiv" data-role="content" style="background-color: blue;">
				<div id="beforPeriodDiv" style="height: 40px; border-bottom: 1px solid #000;">
					第<span id='beforCode'>---</span>期:
					<span id="round1" class="round">-</span><span id="round2" class="round">-</span><span id="round3" class="round">-</span><span id="round4" class="round">-</span><span id="round5" class="round">-</span>
				</div>
				<div id="nowPeriodDiv" class="ui-grid-a" style="background-color: orange; padding: 5px 0px;">
					<div class="ui-block-a">
						第<span id='nowCode'>---</span>期
					</div>
					<div class="ui-block-b" style="text-align:right;">
						<span>封盘:</span><span id="endTimeSpan">--:--</span>&nbsp;
						<span>开奖:</span><span id="finishTimeSpan">--:--</span>
					</div>
				</div>
				<div id="gameDiv" class="ui-grid-a" style="background-color: orange;">
					<div id="leftDiv" class="ui-block-a" style="background-color: yellow; width: 6rem;">
						<div onclick="showRightDiv('rightOneDiv')">两面</div>
						<div onclick="showRightDiv('rightTwoDiv')">1-5球</div>
						<div onclick="showRightDiv('rightThreeDiv')">前中后</div>
					</div>
					<div id="rightOneDiv" class="ui-block-b bet-content" style="background-color: pink;">
						<div class="textCenter col">龙虎、总和</div>
						<div class="ui-grid-a">
							<div class="ui-block-a textCenter col">
								<span class="bet">总和大</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="bet">总和小</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="bet">总和单</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="bet">总和双</span>
								<span>1.995</span>
							</div>
						</div>
						<div class="ui-grid-b">
							<div class="ui-block-a textCenter col">
								<span class="bet">龙</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="bet">虎</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-c textCenter col">
								<span class="bet">和</span>
								<span>1.995</span>
							</div>
						</div>
						<div class="textCenter col">第一球</div>
						<div class="ui-grid-a">
							<div class="ui-block-a textCenter col">
								<span class="bet">大</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="bet">小</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="bet">单</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="bet">双</span>
								<span>1.995</span>
							</div>
						</div>
					</div>
					<div id="rightTwoDiv" class="ui-block-b" style="background-color: orange; display: none;">
						<div class="textCenter col">第一球</div>
						<div class="ui-grid-a">
							<div class="ui-block-a textCenter col">
								<span class="round-1">0</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">1</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">2</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">3</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">4</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">5</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">6</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">7</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">8</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">9</span>
								<span>1.995</span>
							</div>
						</div>
						<div class="textCenter col">第一球</div>
						<div class="ui-grid-a">
							<div class="ui-block-a textCenter col">
								<span class="round-1">0</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">1</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">2</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">3</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">4</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">5</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">6</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">7</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">8</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">9</span>
								<span>1.995</span>
							</div>
						</div>
						<div class="textCenter col">第一球</div>
						<div class="ui-grid-a">
							<div class="ui-block-a textCenter col">
								<span class="round-1">0</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">1</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">2</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">3</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">4</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">5</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">6</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">7</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-a textCenter col">
								<span class="round-1">8</span>
								<span>1.995</span>
							</div>
							<div class="ui-block-b textCenter col">
								<span class="round-1">9</span>
								<span>1.995</span>
							</div>
						</div>
					</div>
					<div id="rightThreeDiv" class="ui-block-b" style="background-color: red; display: none;">
						ccccccc
					</div>
				</div>
			</div>
			
			<div data-role="footer" data-position="fixed" style="height: 120px;">
				<div style="margin-left: 1rem; margin-top: .5rem;">已选中<span>0</span>注</div>
				<div class="ui-grid-a" style="margin-left: 1rem;">
					<div class="ui-block-a" style="width: 10rem; margin-top: 1rem;">
						<input>
					</div>
					<div class="ui-block-b" style="text-align:right;">
						<button style="">下注</button>
						<button>重置</button>
					</div>					
				</div>
			</div>
		</div>
		
		<div data-role="page" id="loginPage">
			<div data-role="header">
				<h1>用户登陆</h1>
			</div>
			<div data-role="content">
				<label for="account">账号：</label><input id="account" name="account" type="text">
				<label for="pwd">密码：</label><input id="pwd" name="pwd" type="password">
				<div style="text-align:center;">
					<input type="button" data-inline="true" onclick="login()" value="登陆">
				</div>
			</div>
		</div>
	</body>
</html>