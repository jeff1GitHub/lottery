<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
		<link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css">
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="js/jquery.mobile-1.3.2.min.js"></script>
		<style type="text/css">
			body {background-color: #88a6b1}
			.round {
				display: inline-block;
    			text-align: center;
			    box-shadow: inset 1px -6px 10px #fff;
			    width: .9rem;
			    height: .9rem;
			    border-radius: .9rem;
			    background: #d5d5d5;
			    color: #000;
			    margin-right: .1rem;
			    line-height: .9rem;
			    font-size: .6rem;
			}
		</style>
		
		<script type="text/javascript">
			var domain = 'http://localhost:8899';
			var userName;
			var token;
			$(function(){
				var screen = $.mobile.getScreenHeight();
				var header = $(".ui-header").hasClass("ui-header-fixed") ? $(".ui-header").outerHeight()  - 1 : $(".ui-header").outerHeight();
				var footer = $(".ui-footer").hasClass("ui-footer-fixed") ? $(".ui-footer").outerHeight() - 1 : $(".ui-footer").outerHeight();
				var contentCurrent = $(".ui-content").outerHeight() - $(".ui-content").height();
				var content = screen - header - footer - contentCurrent;
				$(".ui-content").height(content);
				
				var gridHeight = content - 50;
				$("#contentDiv").height(gridHeight);
				$("#leftDiv").height(gridHeight);
				$("#rightDiv").height(gridHeight);
			});
			
			$(document).on('pageinit', '#mainPage', function () {
				$.ajax({
					url: domain + '/lottery/period/beforPeriod',
					dataType: 'json',
					async: true,
					success: function (result) {
						if(result.code == 200){
							if(result.data){
								$('#beforCode').html(result.data.code);
								
								if(result.data.result){
									var resultArr = result.data.result.split(',');
									$('#round1').html(resultArr[0]);
									$('#round2').html(resultArr[1]);
									$('#round3').html(resultArr[2]);
									$('#round4').html(resultArr[3]);
									$('#round5').html(resultArr[4]);
								}
							}
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
				
				$.ajax({
					url: domain + '/lottery/period/nowPeriod',
					dataType: 'json',
					async: true,
					success: function (result) {
						if(result.code == 200){
							if(result.data){
								$('#nowCode').html(result.data.code);
							}
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
			});
			
			function login() {
				//domain + '/lottery/user/login'?account=hermes&pwd=21232f297a57a5a743894a0e4a801fc3
				var account = $('#account').val();
				var pwd = $('#pwd').val();
				$.ajax({
					url: domain + '/lottery/user/login',
					dataType: 'json',
					async: true,
					data: {
						'account': account,
						'pwd': pwd
					},
					success: function (result) {
						if(result.code == 200){
							userName = result.data.name;
							token = result.data.token;
							alert("登录成功: name=" + userName + " token=" + token);
						}else{
							alert(result.message);
						}
					},
					error: function (request, error) {
						alert('无法连接网络或者返回值错误!');
					}
				});
			}
		</script>
	</head>
	
	<body>
		<div data-role="page" id="mainPage">
			<div data-role="header">
				<h1>欢迎来到我的主页</h1>
				<a class="ui-btn-right" data-rel="dialog" href="#loginPage">登陆</a>
			</div>
			
			<div data-role="content">
				<div style="height: 50px; border-bottom: 1px solid #000;">
					第<span id='beforCode'></span>期:
					<span id="round1" class="round">9</span><span id="round2" class="round">0</span><span id="round3" class="round"></span><span id="round4" class="round"></span><span id="round5" class="round"></span>
				</div>
				<div class="ui-grid-a" style="background-color: orange; height: 30px; padding: 5px 0px;">
					<div class="ui-block-a">
						第<span id='nowCode'>xxxx</span>期
					</div>
					<div class="ui-block-b" style="text-align:right;">
						<span>封盘:</span><span id="endTime">03:05</span>&nbsp;
						<span>开奖:</span><span id="finishTime">04:05</span>
					</div>
				</div>
				<div id="contentDiv" class="ui-grid-a" style="background-color: orange;">
					<div id="leftDiv" class="ui-block-a" style="background-color: yellow;">
						<div>两面</div>
						<div>1-5球</div>
						<div>前中后</div>
					</div>
					<div id="rightDiv" class="ui-block-b" style="background-color: pink;">
						sadas
					</div>
				</div>
			</div>
			
			<div data-role="footer" data-position="fixed" style="height: 50px;">
				<div>已选中<span>0</span>注</div>
			</div>
		</div>
		
		<div data-role="page" id="loginPage">
			<div data-role="header">
				<h1>用户登陆</h1>
			</div>
			<div data-role="content">
				<label for="account">账号：</label><input id="account" name="account" type="text">
				<label for="pwd">密码：</label><input id="pwd" name="pwd" type="password">
				<div style="text-align:center;">
					<input type="button" data-inline="true" onclick="login()" value="登陆">
				</div>
			</div>
		</div>
	</body>
</html>